<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.eci.pdsw.persistence.mybatis.mappers.EquipoSencilloMapper">
    <resultMap type='EquipoSencillo' id='EquipoSencilloResult'>
        <id property='nombre' column='nombre'/>
        <result property='cantidadTotal' column='cantidad_total'/>
        <result property='clase' column='clase'/>
        <result property='fotografia' column='fotografia'/>
        <result property='valorComercial' column='valor_comercial'/>
    </resultMap>
    
     <select id='loadEquipoByNombre' parameterType='map' resultMap='EquipoSencilloResult'>
         select es.nombre as nombre, es.cantidad_total as cantidad_total, es.clase as clase, es.fotografia as fotografia,
         es.valor_comercial as valor_comercial from 
         Equipos_Sencillos as es where es.nombre=#{Eq_Nombre}
     </select>
    
     <insert id='insertEquipo' parameterType='map'>
         insert into Equipos_Sencillos (nombre,cantidad_total,clase,fotografia,valor_comercial)
         values (#{EqSencillo.nombre},#{EqSencillo.cantidadTotal},#{EqSencillo.clase},#{EqSencillo.fotografia},#{EqSencillo.valorComercial})
     </insert>
    
    <select id='loadEquipoByNombreDisponibilidad' parameterType='map'>
       select (es.cantidad_total-eps.cantidad+eps.cantidad_devuelta) as cantidad_disponible from Equipos_Sencillos as es JOIN Equipo_prestamo_sencillo as eps on es.nombre=esp.equipo
       where es.nombre=#{Eq_Nombre}
    </select>
    
    <select id='loadAll'  resultMap='EquipoSencilloResult'>
       select es.nombre as nombre, es.cantidad_total as cantidad_total, es.clase as clase, es.fotografia as fotografia,
       es.valor_comercial as valor_comercial from 
       Equipos_Sencillos as es   
    </select>
    
    <update id='update' parameterType='map'>
        update Equipos_Sencillos as es SET values(#{Eq_Nuevo.nombre},#{Eq_Nuevo.cantidadTotal},#{Eq_Nuevo.clase},#{Eq_Nuevo.fotografia},#{Eq_Nuevo.valorComercial}) 
        where es.nombre=#{Eq_Viejo.nombre}
    </update>
    
</mapper>